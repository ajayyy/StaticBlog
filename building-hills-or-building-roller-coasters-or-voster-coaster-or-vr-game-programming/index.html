<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta name="theme-color" content="#fff"/><style data-href="/styles.98c208488f7e0918f3b4.css" data-identity="gatsby-global-css">body{margin:8px}.profilepic{border-radius:50%;height:80px;overflow:hidden}#title,.profilepic{vertical-align:middle}#title{background-color:#636363;color:#212121;font-family:sans-serif;font-size:50px;padding:20px;text-align:center;transition:font-size 1s}#title,.title-text{text-decoration:none}.title-text:hover{color:#212121}body{background-color:#333;color:#c4c4c4;font-family:sans-serif;font-size:1.1rem;line-height:1.5}code{font-size:12pt!important}a{color:inherit;transition:color .1s linear}a:hover{color:#fff}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}.blog-post-content{margin:auto;max-width:60%;text-align:left}@media screen and (orientation:portrait){.blog-post-content{max-width:100%}}.blog-post-content img{max-width:100%}.blog-post-container{text-align:center}.gatsby-highlight pre[class*=language-].line-numbers{overflow:initial;padding:0 0 0 2.8em}</style><link rel="icon" href="/favicon-32x32.png?v=a60a5f8134c1a0a70ea7cd9216912b32" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="alternate" type="application/rss+xml" title="Ajay Ramachandran&#x27;s Blog" href="/rss.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="title"><img src="/ajay_profile.jpg" class="profilepic"/> <a class="title-text" href="/">Ajay Ramachandran</a></div><main><div class="blog-post-container"><div class="blog-post"><h1>Building Hills | Building Roller Coasters | Voster Coaster | VR Game Programming</h1><h2>July 22, 2018</h2><div class="blog-post-content"><p><a href="https://youtu.be/XGmVYe82HlQ">https://youtu.be/XGmVYe82HlQ</a></p>
<h1>Repository</h1>
<p><a href="https://github.com/ajayyy/VosterCoasterVR">https://github.com/ajayyy/VosterCoasterVR</a></p>
<h1>Inclines</h1>
<p><img src="/images/QmbMg5ZsLqbosd6JEvypnvkXZ9kVGW2zH6GYYBnns4hT3c" alt="image.png"></p>
<p>Inclines are created similarly to turns, except they are rotated upward.</p>
<p>The big issue with this is that the rotation used in all the math had to be changed. Before, only the Y axis was used in math, with inclines, it had to check the x axis.</p>
<h3>Problems with the X axis (Gimbal Lock)</h3>
<p>Rotations in game engines are stored as Quaternions, not angles. With euler angles (3d angles), multiple angles can represent the same angle. Ex. (110, 0, 0) and (70, 180, 180). This causes big issues with the math, as 70 degrees is not the proper angle to do math on in this instance. Luckily this is fixable. I luckily found a fix on <a href="https://answers.unity.com/questions/1299082/transformeulerangles-x-issues.html">unity answers</a>, but I still found this phenomenon very confusing and interesting, so I thought I would share my experience here.</p>
<p><a href="https://github.com/ajayyy/VosterCoaster/commit/7fa09d1cf8e192f17a525f80ca27feb628fc30bc">https://github.com/ajayyy/VosterCoaster/commit/7fa09d1cf8e192f17a525f80ca27feb628fc30bc</a></p>
<h1>Creating a full roller coaster</h1>
<p>A roller coaster is not just flat with a bunch or turns, or many hills but no turns. A roller coaster has a nice combination of both. To achieve this, the user has to be able to create turns on top of inclines, and inclines after a turn.</p>
<h3>Problems with using one axis for rotation (Making inclines work after a turn)</h3>
<p>Using the X axis for rotation works perfectly normally, but completely breaks once an incline needs to be created after a turn, as this moves the axis of rotation of each track piece.</p>
<p>I tried to rotate the angles by adding and subtracting angles, but that turned out not working at all as what needed to happen was axis shifts instead.</p>
<p>After a lot of thinking, I decided to model the situation in a 3D painting program (Tilt Brush), and figured out a solution.</p>
<p><img src="/images/QmQmCmuZdZoGHqraU7BKXHTFNNogLhRxaNBqV4Z8kXDPVB" alt="image.png"></p>
<p>I figured out that the axis changes could be discovered using sin and cosine. By looking the rotations and positions of the track for 4 situations (0 degrees, 90, 180, 270), I was able to find the pattern.</p>
<div class="gatsby-highlight" data-language="c#"><pre style="counter-reset: linenumber NaN" class="language-c# line-numbers"><code class="language-c#">//adjust angle to make it like it was normal
float angle = Mathf.Cos(currentAngle.y * Mathf.Deg2Rad) * fullTargetAngle.x + Mathf.Sin(currentAngle.y * Mathf.Deg2Rad + Mathf.PI) * fullTargetAngle.z;

targetAngle = new Vector3(angle, 0, 0);</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>The original angle could be found this way. Here is a list of the angles at the 4 angles mentioned above.(top X, bottom Z)</p>
<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">45  0  -45  0
0  45  0  45</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>So to find the original angles you can use</p>
<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">0  45   90   45
0 -45    0  -45</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>These numbers can be represented by sin and cosine waves.</p>
<p>This same process was used to find the positions at the rotations</p>
<div class="gatsby-highlight" data-language="c#"><pre style="counter-reset: linenumber NaN" class="language-c# line-numbers"><code class="language-c#">//theoretical position as if it was at a normal position
float x = Mathf.Sin(currentAngle.y * Mathf.Deg2Rad) * targetPosition.x + Mathf.Cos(currentAngle.y * Mathf.Deg2Rad) * targetPosition.z;
float y = targetPosition.y;

//set that position so that future calculations use that position instead
targetPosition = new Vector3(0, y, x);</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h3>Turns after an incline</h3>
<p>Luckily, this was much easier to implement. All turns need to do is be at the same height as the previous track, and make sure not to take the previous angle in to effect when creating the track, or else the turn will turn into an incline. Instead, it ignores that angle and only checks for the Y axis angle.</p>
<p>I hope in the future to make it possible to make barrel rolling tracks (turn to the side instead of up or down).</p>
<h1>Automatic Straight Tracks</h1>
<p>The only way to make a straight track would be to somehow balance your hand steady enough to form a straight angle. This is practically impossible, so I added a button to force a straight path when needed.</p>
<h1>Auto-complete</h1>
<p>I also added basic auto complete functionality. It will automatically set the first track piece as the target position and rotation so that the track will turn toward the original start track and finish it. It will then disable editing mode.</p>
<h1>Pull Request</h1>
<p><a href="https://github.com/ajayyy/VosterCoaster/pull/13">https://github.com/ajayyy/VosterCoaster/pull/13</a></p>
<p>You can see the full set of changes in the pull request. This post only includes an overview of major changes.</p>
<h1>GitHub Account</h1>
<p><a href="https://github.com/ajayyy">https://github.com/ajayyy</a></p></div></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/building-hills-or-building-roller-coasters-or-voster-coaster-or-vr-game-programming";window.___webpackCompilationHash="ee9f93a22f5d812d53ee";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2027c615c2b1d449723b.js"],"app":["/app-a8a88917d557b5d5c239.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6e293d823d5e173acc7a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-4c00f30d3c318a368679.js"],"component---src-pages-sponsorblock-js":["/component---src-pages-sponsorblock-js-03e17db57ab08e6d8408.js"],"component---src-pages-vostercoaster-js":["/component---src-pages-vostercoaster-js-dee0d7b7fa6b58872b3e.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-d0d2c490581e9ed2d6f1.js"]};/*]]>*/</script><script src="/polyfill-2027c615c2b1d449723b.js" nomodule=""></script><script src="/app-a8a88917d557b5d5c239.js" async=""></script><script src="/framework-c0acfd4b44c09a0159f3.js" async=""></script><script src="/webpack-runtime-f415ec79cfe5feaa0178.js" async=""></script></body></html>