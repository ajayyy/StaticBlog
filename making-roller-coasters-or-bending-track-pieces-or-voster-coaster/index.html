<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta name="theme-color" content="#fff"/><style data-href="/styles.98c208488f7e0918f3b4.css" data-identity="gatsby-global-css">body{margin:8px}.profilepic{border-radius:50%;height:80px;overflow:hidden}#title,.profilepic{vertical-align:middle}#title{background-color:#636363;color:#212121;font-family:sans-serif;font-size:50px;padding:20px;text-align:center;transition:font-size 1s}#title,.title-text{text-decoration:none}.title-text:hover{color:#212121}body{background-color:#333;color:#c4c4c4;font-family:sans-serif;font-size:1.1rem;line-height:1.5}code{font-size:12pt!important}a{color:inherit;transition:color .1s linear}a:hover{color:#fff}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}.blog-post-content{margin:auto;max-width:60%;text-align:left}@media screen and (orientation:portrait){.blog-post-content{max-width:100%}}.blog-post-content img{max-width:100%}.blog-post-container{text-align:center}.gatsby-highlight pre[class*=language-].line-numbers{overflow:initial;padding:0 0 0 2.8em}</style><link rel="icon" href="/favicon-32x32.png?v=a60a5f8134c1a0a70ea7cd9216912b32" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="alternate" type="application/rss+xml" title="Ajay Ramachandran&#x27;s Blog" href="/rss.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="title"><img src="/ajay_profile.jpg" class="profilepic"/> <a class="title-text" href="/">Ajay Ramachandran</a></div><main><div class="blog-post-container"><div class="blog-post"><h1>Bending Track Pieces | Building Roller Coasters | Voster Coaster</h1><h2>June 09, 2018</h2><div class="blog-post-content"><h1>Repository</h1>
<p><a href="https://github.com/ajayyy/VosterCoasterVR/">https://github.com/ajayyy/VosterCoasterVR/</a></p>
<h1>What is Voster Coaster?</h1>
<p>Voster Coaster is a VR game where you build roller coasters. I plan on making it a theme park tycoon game in the future as well.</p>
<h1>What was added?</h1>
<p>In this update I focused on the ability to form a full roller coaster from parts. To do so, I implemented a system that could take a track piece and bend it to add an incline, or make it a turn piece. This is going to be used to make a full spline-based roller coaster creator in the future.</p>
<p><img src="/images/Qmeq3eZj6ehPgut499D85qypLJNQCU2dHM6AtsQrohwEfJ" alt="image.png">
<img src="/images/QmNVLJH9SBwREpQhrKXuATqVyB9rrPezZrw5fZ4mKSLBGV" alt="image.png"></p>
<h1>How was this implemented?</h1>
<h3>Bones</h3>
<p>3D models can have bones, and adding bones makes it much easier to programatically modify the meshes. In Cinema 4D, I added 10 bones to split each rail into 10 modifiable sections.</p>
<h3>Bones become objects</h3>
<p>In Unity, bones get represented as movable objects in the hierarchy. These objects can be moved around just as if they were a normal game object.</p>
<p><img src="/images/QmaGDKJAVNaxiHPumfjjnfdc3mrpNrcLkj8tr8UmUSy2uq" alt="image.png"></p>
<h3>Exponential looking curves</h3>
<p>In Unity you can set an object's local rotation by using <code class="language-text">gameObject.transform.localEulerAngles</code>. By setting all the objects to have the same local rotation, it creates an exponential looking curve.</p>
<p>The first object is slightly rotated, the next is moved forward in the direction of the previous bone, and then slightly rotated more. This continues for all of the bones</p>
<h3>Targeting an angle</h3>
<p>There are 9 usable bones (as the first bone should stay at an angle of 0 to look straight). This means that if you set all of the <code class="language-text">gameObject.transform.localEulerAngles</code> to <code class="language-text">targetAngle/9</code>, it will move toward the target angle.</p>
<p>For example, if the target angle is 90 degrees, you can set each angle to 10 degrees.</p>
<div class="gatsby-highlight" data-language="c#"><pre style="counter-reset: linenumber NaN" class="language-c# line-numbers"><code class="language-c#">for (int i = 0; i &lt; rails.Length; i++) {
            for (int r = 1; r &lt; rails[i].Length - 1; r++) {
                //Attempt to rotate them all
                rails[i][r].transform.localEulerAngles += adjustmentAngle;
            }
 }</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h3>Length Distortion</h3>
<p>By having an exponential, the total distance traveled of the curves will be much smaller than the original. To account for that, a ratio is calculated to figure out how to make the curve reach the full length.</p>
<div class="gatsby-highlight" data-language="c#"><pre style="counter-reset: linenumber NaN" class="language-c# line-numbers"><code class="language-c#">//try to stretch the newly shaped incline to the proper size
    for (int i = 0; i &lt; rails.Length; i++) {
        //get relative total offset for the adjusted track
        float difference = rails[i][rails[i].Length - 1].transform.position.z - rails[i][0].transform.position.z;

        float multiplier = sizes[i] / difference;

        for (int r = 1; r &lt; rails[i].Length - 1; r++) {
            Vector3 pos = rails[i][r].transform.position;

            rails[i][r].transform.localPosition *= multiplier;
        }
}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>sizes[i] is a previous value calculated earlier of the original size.</p>
<div class="gatsby-highlight" data-language="c#"><pre style="counter-reset: linenumber NaN" class="language-c# line-numbers"><code class="language-c#">sizes[i] = rails[i][rails[i].Length - 1].transform.position.z - rails[i][0].transform.position.z;</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<h3>Turns</h3>
<p>For turns, each rail would be a different size, as they have to travel further to reach the same spot (it is like a bigger circle.</p>
<p><img src="/images/QmPAx2Eg4GeF2mQrmYLm9QFpFm4hg8LZjXkNqCGhZmVujW" alt="image.png"></p>
<p>As you can see in the above image, if the curve is the same size, it will not reach the same point. The orange is where the curve <strong>should</strong> reach to.</p>
<p>To accommodate for this, the outside circles must be stretched based on their difference from the inside circles.</p>
<div class="gatsby-highlight" data-language="c#"><pre style="counter-reset: linenumber NaN" class="language-c# line-numbers"><code class="language-c#">for (int r = 1; r &lt; rails[i].Length - 1; r++) {
      if (adjustmentAngle.y != 0) { //making a turn, extend outside curves to accommodate
          int insideRail = 0;
          if (adjustmentAngle.y &gt; 0) {
              insideRail = 1;
          }

          if (i != insideRail) { //in this case, 1 is the inside rail (doing just zero for now as a test, in the final version it should be based on if the angle is negative or positive)
               //get full offset compared to rails[insideRail]
               float offset = Mathf.Abs(railParents[insideRail].transform.position.x) + Mathf.Abs(railParents[i].transform.position.x);

               //radius of the inside circle
              float radius1 = Mathf.Abs(sizes[i]);
             //radius of outside circle (rails[i])
             float radius2 = radius1 + offset;

             print(radius1 + &quot;  &quot; + radius2 + &quot;    &quot; + radius2/radius1);

             rails[i][r].transform.localPosition *= radius2 / radius1;
         }
    }
}</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Inside rail is the index of the inside rail. This will change depending on if the turn is to the left or to the right. This will only happen if the adjustmentAngle is a y value, as y value angles are turns, and x value angles are inclines.</p>
<h1>GitHub Account</h1>
<p><a href="https://github.com/ajayyy/">https://github.com/ajayyy/</a></p>
<h1>Pull Request</h1>
<p><a href="https://github.com/ajayyy/VosterCoasterVR/pull/3">https://github.com/ajayyy/VosterCoasterVR/pull/3</a></p>
<p>Small hotfix: <a href="https://github.com/ajayyy/VosterCoasterVR/pull/4">https://github.com/ajayyy/VosterCoasterVR/pull/4</a></p></div></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/making-roller-coasters-or-bending-track-pieces-or-voster-coaster";window.___webpackCompilationHash="ee9f93a22f5d812d53ee";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2027c615c2b1d449723b.js"],"app":["/app-a8a88917d557b5d5c239.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6e293d823d5e173acc7a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-4c00f30d3c318a368679.js"],"component---src-pages-sponsorblock-js":["/component---src-pages-sponsorblock-js-03e17db57ab08e6d8408.js"],"component---src-pages-vostercoaster-js":["/component---src-pages-vostercoaster-js-dee0d7b7fa6b58872b3e.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-d0d2c490581e9ed2d6f1.js"]};/*]]>*/</script><script src="/polyfill-2027c615c2b1d449723b.js" nomodule=""></script><script src="/app-a8a88917d557b5d5c239.js" async=""></script><script src="/framework-c0acfd4b44c09a0159f3.js" async=""></script><script src="/webpack-runtime-f415ec79cfe5feaa0178.js" async=""></script></body></html>