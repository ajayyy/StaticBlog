<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta name="theme-color" content="#fff"/><style data-href="/styles.98c208488f7e0918f3b4.css" data-identity="gatsby-global-css">body{margin:8px}.profilepic{border-radius:50%;height:80px;overflow:hidden}#title,.profilepic{vertical-align:middle}#title{background-color:#636363;color:#212121;font-family:sans-serif;font-size:50px;padding:20px;text-align:center;transition:font-size 1s}#title,.title-text{text-decoration:none}.title-text:hover{color:#212121}body{background-color:#333;color:#c4c4c4;font-family:sans-serif;font-size:1.1rem;line-height:1.5}code{font-size:12pt!important}a{color:inherit;transition:color .1s linear}a:hover{color:#fff}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}.blog-post-content{margin:auto;max-width:60%;text-align:left}@media screen and (orientation:portrait){.blog-post-content{max-width:100%}}.blog-post-content img{max-width:100%}.blog-post-container{text-align:center}.gatsby-highlight pre[class*=language-].line-numbers{overflow:initial;padding:0 0 0 2.8em}</style><link rel="icon" href="/favicon-32x32.png?v=a60a5f8134c1a0a70ea7cd9216912b32" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a60a5f8134c1a0a70ea7cd9216912b32"/><link rel="alternate" type="application/rss+xml" title="Ajay Ramachandran&#x27;s Blog" href="/rss.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="title"><img src="/ajay_profile.jpg" class="profilepic"/> <a class="title-text" href="/">Ajay Ramachandran</a></div><main><div class="blog-post-container"><div class="blog-post"><h1>Ready for Rollout | SponsorBlock | YouTube Sponsorship Segment Blocker</h1><h2>July 22, 2019</h2><div class="blog-post-content"><h4>Repository</h4>
<p><a href="https://github.com/ajayyy/SponsorBlock">https://github.com/ajayyy/SponsorBlock</a>
<a href="https://github.com/ajayyy/SponsorBlockServer">https://github.com/ajayyy/SponsorBlockServer</a></p>
<h1>SponsorBlock</h1>
<blockquote>
<p>SponsorBlock is an extension that skips over sponsored segments of YouTube videos. SponsorBlock is a crowdsourced browser extension that let's anyone submit the start and end time's of sponsored segments of YouTube videos. Once one person submits this information, everyone else with this extension will skip right over the sponsored segment.</p>
<p>In summary, it's a crowd-sourced adblock for sponsored sections of YouTube videos.</p>
</blockquote>
<h1>Client Side</h1>
<ul>
<li>Made it possible for multiple notices to appear, added an animation for it.</li>
</ul>
<p><img src="/images/KbpbivRJ-mutliple20notices.gif" alt="mutliple notices.gif"></p>
<ul>
<li>Added button to popup to allow you to vote from the popup.</li>
</ul>
<p><img src="/images/pKwBlmYP-image.png" alt="image.png"></p>
<ul>
<li>
<p>Added messages to indicate the status of different things, such as errors or that it's loading</p>
</li>
<li>
<p>Added submit button on the video player.</p>
</li>
</ul>
<p><img src="/images/rymnMa7n-submit20animation.gif" alt="submit animation.gif"></p>
<ul>
<li>Made it keep checking for submitted sponsor times every 10 seconds on recent videos.</li>
</ul>
<p>This should help a lot for when videos are just published, so even if you are one of the first to watch a video, you might still get some sponsors skipped by people having submitted info by the time you reach near the end of the video.</p>
<p>This uses the API provided by invidious that gives out the date a video was published in seconds. This number can then be checked to see if it is less than 3 days old.</p>
<ul>
<li>Switched it from using local storage to synced storage.</li>
</ul>
<p>Now, you should be treated as the same user when switching devices.</p>
<ul>
<li>Added small notice of how many submissions this user has made.</li>
</ul>
<p>This should help encourage people to submit info, as they can see exactly how much they have helped.</p>
<h1>Server-side</h1>
<ul>
<li>Preventing voting twice except for changing a vote</li>
</ul>
<p>This makes it so a user can vote on something they have already voted on if they are going to change their vote. They can change their upvote to a downvote.</p>
<ul>
<li>Made it order the sponsor times by start time.</li>
</ul>
<p>This looks so much better in the UI for reporting times, as it shows it in chronological order.</p>
<p><img src="https://files.steempeak.com/file/steempeak/ajayyy/pKwBlmYP-image.png" alt="image.png"></p>
<ul>
<li>Added rate limit per day per IP</li>
</ul>
<p>This should prevent spam from one IP. Maybe it can be changed to an hourly limit/</p>
<ul>
<li>Made it run the hash function 5000 times to ensure no one will brute force the IPs.</li>
</ul>
<p>The longer it takes to run a hash function, the harder it is to brute force. Since the database is completely public, any sensitive information stored, such as IP addresses, needs to be saved in a way cannot be retrieved by anyone. IPs must be saved to prevent spam, but the actual IP isn't needed, just a hash to compare against.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token comment">//hash the ip so no one can get it from the database</span>
<span class="token keyword">let</span> hashedIP <span class="token operator">=</span> ip <span class="token operator">+</span> globalSalt<span class="token punctuation">;</span>
<span class="token comment">//hash it 5000 times, this makes it very hard to brute force</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> hashCreator <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha512'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hashedIP <span class="token operator">=</span> hashCreator<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>hashedIP<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h1>Next steps</h1>
<p>I am now working on a port of this extension to Firefox. Once this is done, the extension will be available on both stores and be officially released.</p>
<h4>Pull Requests</h4>
<p><a href="https://github.com/ajayyy/SponsorBlock/pull/3">https://github.com/ajayyy/SponsorBlock/pull/3</a>
<a href="https://github.com/ajayyy/SponsorBlockServer/pull/4">https://github.com/ajayyy/SponsorBlockServer/pull/4</a></p>
<h4>GitHub Account</h4>
<p><a href="https://github.com/ajayyy">https://github.com/ajayyy</a></p></div></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ready-for-rollout-or-sponsorblock-or-youtube-sponsorship-segment-blocker";window.___webpackCompilationHash="ee9f93a22f5d812d53ee";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2027c615c2b1d449723b.js"],"app":["/app-a8a88917d557b5d5c239.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6e293d823d5e173acc7a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-4c00f30d3c318a368679.js"],"component---src-pages-sponsorblock-js":["/component---src-pages-sponsorblock-js-03e17db57ab08e6d8408.js"],"component---src-pages-vostercoaster-js":["/component---src-pages-vostercoaster-js-dee0d7b7fa6b58872b3e.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-d0d2c490581e9ed2d6f1.js"]};/*]]>*/</script><script src="/polyfill-2027c615c2b1d449723b.js" nomodule=""></script><script src="/app-a8a88917d557b5d5c239.js" async=""></script><script src="/framework-c0acfd4b44c09a0159f3.js" async=""></script><script src="/webpack-runtime-f415ec79cfe5feaa0178.js" async=""></script></body></html>